<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stock Tracker</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Real-Time Stock Tracker</h1>
  <div class="stock-container">
    <div class="stock-card">
      <div class="stock-symbol">AAPL</div>
      <div class="stock-price loading" id="AAPL-price">Loading...</div>
      <div class="stock-timestamp" id="AAPL-timestamp"></div>
    </div>
    <div class="stock-card">
      <div class="stock-symbol">GOOGL</div>
      <div class="stock-price loading" id="GOOGL-price">Loading...</div>
      <div class="stock-timestamp" id="GOOGL-timestamp"></div>
    </div>
    <div class="stock-card">
      <div class="stock-symbol">MSFT</div>
      <div class="stock-price loading" id="MSFT-price">Loading...</div>
      <div class="stock-timestamp" id="MSFT-timestamp"></div>
    </div>
    <div class="stock-card">
      <div class="stock-symbol">AMZN</div>
      <div class="stock-price loading" id="AMZN-price">Loading...</div>
      <div class="stock-timestamp" id="AMZN-timestamp"></div>
    </div>
    <div class="stock-card">
      <div class="stock-symbol">TSLA</div>
      <div class="stock-price loading" id="TSLA-price">Loading...</div>
      <div class="stock-timestamp" id="TSLA-timestamp"></div>
    </div>
  </div>

  <script>
    const ws = new WebSocket("ws://localhost:3000");

    ws.onopen = () => {
      console.log('Connected to WebSocket server');
    };

    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);
      const symbol = data.symbol;
      const price = parseFloat(data.price).toFixed(2);
      const timestamp = new Date(data.timestamp).toLocaleTimeString();
      
      // Update the specific stock's price and timestamp
      const priceElement = document.getElementById(`${symbol}-price`);
      const timestampElement = document.getElementById(`${symbol}-timestamp`);
      
      if (priceElement) {
        priceElement.textContent = `$${price}`;
        priceElement.className = 'stock-price'; // Remove loading class
      }
      
      if (timestampElement) {
        timestampElement.textContent = `Updated: ${timestamp}`;
      }
    };

    ws.onclose = () => {
      console.log('Disconnected from WebSocket server');
    };

    ws.onerror = (error) => {
      console.error('WebSocket error:', error);
    };
  </script>
</body>
</html>
